import{r as o,j as r,P as B,S as m,B as x,T as d,D as R,F as v,I as y,a as M,M as A,q as _,t as h,v as k,d as W}from"./index-ddzL1-Av.js";import{e as f}from"./tiaData-_HO0snSy.js";const s={bg:"#f4f6f8",paper:"#ffffff",primary:"#1b5e20",bars:"#59A14F",text:"#000000ff",tabUnselected:"#000000ff"},E=a=>a==null?"":String(a).replace(/^'+/,""),I=a=>a==null||Number.isNaN(a)?"—":`${(a*100).toFixed(1)}%`;function L({subject:a="algebra"}){const[n,S]=o.useState(2024),[p,j]=o.useState("All Students"),[i,U]=o.useState("Approaches"),l=a==="english"?"English I":"Algebra I",N=17,P=17,c=o.useMemo(()=>{const e=new Set((f||[]).filter(t=>String(t.subject)===String(l)).map(t=>t.year));return Array.from(e).sort((t,g)=>t-g)},[l]),b=o.useMemo(()=>{const e=new Set((f||[]).filter(t=>String(t.subject)===String(l)&&Number(t.year)===Number(n)).map(t=>t.subgroup));return Array.from(e).sort((t,g)=>t.localeCompare(g))},[l,n]);o.useEffect(()=>{!c.includes(n)&&c.length>0&&S(c[c.length-1])},[c]),o.useEffect(()=>{b.includes(p)||j(b.includes("All Students")?"All Students":b[0]||"All Students")},[b]);const u=o.useMemo(()=>(f||[]).filter(e=>String(e.subject)===String(l)&&Number(e.year)===Number(n)&&String(e.subgroup)===String(p)).map(e=>({...e,CAMPUS_ID:E(e.CAMPUS_ID)})),[l,n,p]),C=o.useMemo(()=>{const e=u.filter(t=>t.level===i&&t.rate!=null);return e.sort((t,g)=>String(t.CAMPUS).localeCompare(String(g.CAMPUS))),e.map(t=>({campus:t.CAMPUS,rate:t.rate}))},[u,i]),T=o.useMemo(()=>new Set(u.map(t=>t.CAMPUS)).size,[u]),w=o.useMemo(()=>u.filter(e=>e.level===i&&e.rate==null).length,[u,i]),z={mb:0,"& .MuiToggleButton-root":{textTransform:"none",fontWeight:600,fontSize:"1rem",color:s.tabUnselected,backgroundColor:"rgba(0,0,0,0.05)",borderRadius:2,px:3,minHeight:40,border:"none",transition:"all 0.2s ease","&:hover":{backgroundColor:"rgba(0,0,0,0.1)",color:s.primary}},"& .MuiToggleButton-root.Mui-selected":{color:"#ffffff",backgroundColor:s.primary,boxShadow:"0 4px 12px rgba(27, 94, 32, 0.3)","&:hover":{backgroundColor:s.primary}}};return r.jsx(B,{elevation:0,sx:{p:{xs:2,md:3},borderRadius:3,border:"1px solid",borderColor:"divider",backgroundColor:s.paper},children:r.jsxs(m,{spacing:2,children:[r.jsxs(x,{children:[r.jsx(d,{variant:"h6",sx:{fontWeight:800,color:s.text},children:"STAAR Rates by Campus"}),r.jsxs(d,{variant:"body2",sx:{color:s.tabUnselected},children:[l," • Filter by year and subgroup, then choose Approaches/Meets/Masters to compare campuses."]})]}),r.jsx(R,{}),r.jsxs(m,{direction:{xs:"column",md:"row"},spacing:2,alignItems:{xs:"stretch",md:"center"},justifyContent:"space-between",children:[r.jsxs(m,{direction:{xs:"column",sm:"row"},spacing:2,flexWrap:"wrap",children:[r.jsxs(v,{size:"small",sx:{minWidth:160},children:[r.jsx(y,{children:"Year"}),r.jsx(M,{value:n,label:"Year",onChange:e=>S(e.target.value),children:c.map(e=>r.jsx(A,{value:e,children:e},e))})]}),r.jsxs(v,{size:"small",sx:{minWidth:260},children:[r.jsx(y,{children:"Subgroup"}),r.jsx(M,{value:p,label:"Subgroup",onChange:e=>j(e.target.value),children:b.map(e=>r.jsx(A,{value:e,children:e},e))})]}),r.jsxs(_,{size:"small",exclusive:!0,value:i,onChange:(e,t)=>t&&U(t),sx:z,children:[r.jsx(h,{value:"Approaches",children:"Approaches"}),r.jsx(h,{value:"Meets",children:"Meets"}),r.jsx(h,{value:"Masters",children:"Masters"})]})]}),r.jsxs(m,{direction:"row",spacing:1,alignItems:"center",children:[r.jsx(k,{size:"small",label:`${T} campuses`,variant:"outlined",sx:{color:s.text,borderColor:"rgba(0,0,0,0.15)"}}),r.jsx(k,{size:"small",label:`${w} missing`,variant:"outlined",sx:{color:s.text,borderColor:"rgba(0,0,0,0.15)"}})]})]}),r.jsx(x,{sx:{height:{xs:420,md:520}},children:C.length===0?r.jsx(x,{sx:{height:"100%",display:"grid",placeItems:"center",borderRadius:2,border:"1px dashed",borderColor:"divider",backgroundColor:s.bg},children:r.jsx(d,{variant:"body2",sx:{color:s.tabUnselected},children:"No chartable values for this selection (all missing/suppressed)."})}):r.jsx(W,{data:C,keys:["rate"],indexBy:"campus",margin:{top:30,right:20,bottom:120,left:75},padding:.25,valueScale:{type:"linear",min:0,max:1},indexScale:{type:"band",round:!0},colors:()=>s.bars,enableLabel:!0,label:e=>I(e.value),labelSkipWidth:12,labelSkipHeight:12,labelTextColor:"#080000ff",labelPosition:"end",labelOffset:-5,borderWidth:1,borderColor:{from:"color",modifiers:[["darker",.6]]},axisLeft:{tickValues:6,legend:"Rate",legendPosition:"middle",legendOffset:-60,format:e=>`${Math.round(e*100)}%`},axisBottom:{tickRotation:0,legend:"Campus",legendPosition:"middle",legendOffset:55},tooltip:({indexValue:e,value:t})=>r.jsxs(x,{sx:{p:1,bgcolor:s.paper,border:"1px solid",borderColor:"divider",borderRadius:2},children:[r.jsx(d,{variant:"subtitle2",sx:{fontWeight:800,color:s.text},children:e}),r.jsxs(d,{variant:"body2",sx:{color:s.tabUnselected},children:[l," • ",p," • ",i,":"," ",r.jsx("b",{style:{color:s.primary},children:I(t)})]})]}),theme:{axis:{ticks:{text:{fill:s.tabUnselected,fontSize:N}},legend:{text:{fill:s.tabUnselected,fontSize:P}}},labels:{text:{fill:"#000000ff",fontSize:18,fontWeight:300}},tooltip:{container:{background:"transparent"}},grid:{line:{stroke:"rgba(0,0,0,0.08)"}}}})}),r.jsx(d,{variant:"caption",sx:{color:s.tabUnselected},children:"Note: “missing” usually means suppressed or unavailable subgroup counts (null rate)."})]})})}export{L as default};
